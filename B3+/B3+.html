<!DOCTYPE html>
<html>
<head>
	<title>B3+</title>
<style type="text/css"> 

</style> 
<script>
	/*
	Написать функцию-калькулятор вручную введённого выражения (без использования функции eval и динамического описания функции new Function, если вы знаете о них).
Должны работать операции + - * / и скобки, числа должны приниматься целые, дробные (через точку), отрицательные
Например, вызываем функцию, передавая ей строку "2*(3+1)", функция возвращает 8.
	*/
</script>
</head>
<body>

 
<script type="text/javascript"> 
"use strict";

var str=prompt("","2*(3+1)+1");

function calculator(matString) {

	var multdiv=function(sub, a, sign, b) { //функция деления/умножения
		if(sign=='*'){
			return a*b;
		}else{
			return a/b;
		};
	};

	var addsub=function(sub, a, sign, b) { //функция суммы/разности
		if(sign=='-'){
			return a-b;
		} else{
			return +a + +b;	
		};
	};

	var checkAddSub= /(-?[\d\.]+)\s*([\+-])\s*(-?[\d\.]+)/g;
	var checkMultDiv= /(-?[\d\.]+)\s*([\*\/])\s*(-?[\d\.]+)/g;

	var getExpression= function(sub, expression) { //функция подсчета

 	while(checkAddSub.test(expression) || checkMultDiv.test(expression)){ //проверка на условие
 	
 		expression= expression.replace(checkMultDiv, multdiv);
 		expression= expression.replace(checkAddSub, addsub);
 	};
 	return expression;
	};

	while(matString.indexOf("(") !== -1){ // очистка скобок
		matString=matString.replace(/\(([^\(\)]*)\)/g, getExpression);
	};
	return getExpression("", matString);

};
alert(calculator(str));
</script>
</body>
</html>
